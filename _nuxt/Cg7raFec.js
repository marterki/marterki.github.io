import{d as z,r as f,G as C,i as h,c as d,o as l,e as m,F as P,j as M,D as S,m as p,t as A,g as F,H as L,u as Q,I as U,a as k,b as E,J as G,z as J,f as T,w as K,E as q,_ as O,K as W}from"./Bwfdgr8x.js";import{_ as X}from"./wZDOUAnG.js";import{p as u}from"./DzIAmVDu.js";import{p as Y}from"./C1KQYdHD.js";const Z={class:"container-fluid page-pt section-mb-xs"},ee=["innerHTML"],te={class:"d-flex flex-row flex-wrap justify-content-center"},oe=["onClick"],ae=z({__name:"CategoriesFilterBar",props:{visibleCategories:{},modelValue:{}},emits:["update:modelValue"],setup(b,{emit:g}){const r=b,a=f(r.modelValue),i=C(()=>{var t;return(t=a.value)==null?void 0:t.id});function _(t){a.value=t,setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},100)}const n=g;return h(()=>a.value,()=>{n("update:modelValue",a.value)}),h(()=>r.modelValue,()=>{var t;i.value!=((t=r.modelValue)==null?void 0:t.id)&&(a.value=r.modelValue)},{immediate:!0}),(t,v)=>(l(),d("div",Z,[m("h1",{class:"heading-mb text-center",innerHTML:t.$t("shop.heading")},null,8,ee),m("ul",te,[(l(!0),d(P,null,M(t.visibleCategories,o=>(l(),d("li",{key:o.id,class:"category-item"},[m("button",{class:S({active:p(i)!=null&&p(i)==o.id}),onClick:y=>_(o)},A(o.localizedName()),11,oe)]))),128))])]))}}),se=F(ae,[["__scopeId","data-v-a6b5453c"]]),ne={class:"container-fluid section-mb"},re={class:"row g-2 justify-content-center"},le=["id"],me=z({__name:"products",async setup(b){let g,r;const a=L(),{t:i}=Q(),_=Y.getAllVisibleProducts(),n=u.getAllVisibleCategories().filter(e=>_.some(s=>s.productCategoryId==e.id)),t=[];for(const e of n)t.push(`/shop?category=${e.nameEng}`);[g,r]=U(()=>x()),await g,r();const v=a.currentRoute.value.query,o=f(I()),y=C(()=>o.value.id),V=C(()=>o.value.nameEng);$();function w(){return o.value==null?[]:_.filter(e=>e.productCategoryId==y.value)}async function x(){const e=a.currentRoute.value.query;(!e.category||!n.some(s=>s.nameEng==e.category))&&await a.replace({query:{category:u.getCategoryById(1).nameEng}})}function I(){const e=v.category;return u.getCategoryByName(e)??n[0]}function $(){const e=I().localizedName();k({title:`lioi | ${e}`,meta:[{name:"description",content:i("home.hero.body")}]}),E({ogTitle:`lioi | ${e}`,ogUrl:"https://lioi.ee",ogType:"website",ogDescription:i("home.hero.body"),ogImage:"/img/contact-1.jpg"})}const B=f(!1);return G(async()=>{await x(),o.value=u.getCategoryByName(v.category)||n[0]}),J(()=>{$(),B.value=!0}),h(()=>o.value,async()=>{var e,s;a.currentRoute.value.query.category!=V.value&&(await a.replace({query:{category:V.value}}),E({ogTitle:`lioi | ${(e=u.getCategoryById(y.value))==null?void 0:e.localizedName()}`}),k({title:`lioi | ${(s=u.getCategoryById(y.value))==null?void 0:s.localizedName()}`}))}),(e,s)=>{var N;const R=se,j=O,D=X;return l(),d("div",null,[T(j,null,{default:K(()=>{var c;return[(c=p(n))!=null&&c.length?(l(),W(R,{key:0,"visible-categories":p(n),modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=H=>o.value=H)},null,8,["visible-categories","modelValue"])):q("",!0)]}),_:1}),m("div",ne,[m("div",re,[(N=w())!=null&&N.length&&B.value?(l(!0),d(P,{key:0},M(w(),c=>(l(),d("div",{class:"col-6 col-lg-4 col-xxl-3",key:c.id,id:`product-${c.id}`},[T(D,{product:c},null,8,["product"])],8,le))),128)):q("",!0)])])])}}});export{me as default};
